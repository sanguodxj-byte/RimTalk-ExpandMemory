# v3.3.21 更新说明

## ?? 标签测试工具 - 帮你写出完美的标签！

### 新功能

**?? 标签测试工具**
- 实时测试标签是否会匹配对话
- 支持 Pawn 模拟（查看技能如何影响匹配）
- 清晰的结果显示（?匹配 / ?不匹配）
- 完整的匹配文本显示

**?? 使用说明按钮**
- 内置完整的使用指南
- 标签最佳实践
- 技能名陷阱警告
- 常见问题 FAQ

### 使用方法

1. 打开常识库界面
2. 点击左侧 **?? 标签测试** 按钮（浅绿色）
3. 输入标签、对话、选择 Pawn（可选）
4. 点击 **?? 测试**
5. 查看结果和实际匹配文本

### 为什么需要标签测试？

**问题场景**：
```
你创建了标签：[射击]
期望：只在讨论射击时触发
实际：在射击专家（≥10级）的所有对话中都会触发！

原因：匹配文本 = 对话 + Pawn名字 + 性别 + 特性 + 技能(≥10级)
     "今天天气不错" + "张三 女性 人类 工作狂 射击 近战"
                                              ↑
                                         技能名被自动添加！
```

**现在有了测试工具**：
- ? 输入标签 `[射击]` + 对话 `今天天气不错` + Pawn `张三（射击15级）`
- ? 测试结果：**? 匹配成功**（误触！）
- ? 看到实际匹配文本包含 "射击"
- ? 优化为 `[规则-射击战斗,瞄准]`
- ? 再次测试：**? 不匹配**（符合预期！）

### 标签最佳实践

**? 推荐**：
```
[规则-射击战斗,瞄准]  // 组合标签，精确触发
[世界观-星球,环世界]  // 避免短标签
[角色-张三-背景]      // 分层标签
```

**? 避免**：
```
[射击]  // 单一技能名，会误触
[星]    // 太短，匹配"火星""星际""星期"
[人]    // 过于宽泛
```

### Bug 修复

- 修复标签测试工具结果区域与输入重叠
- 优化窗口布局（650x600像素）

### 如何访问帮助

常识库界面 → 左侧边栏 → **?? 使用说明** 按钮（浅蓝色）

---

**版本**: v3.3.21  
**发布**: 2025-12-20  
**兼容**: RimWorld 1.5/1.6
